# 所有权

链接书籍《Rust权威指南》

<mark style="color:red;">**借用、切片，以及Rust在内存中布局数据的方式。**</mark>



所有权使用包含特定规则的所有权系统来管理内存，这套规则<mark style="color:orange;">允许编译器在编译过程中执行检查工作，而不会产生任何的运行时开销。</mark>

对于Rust这样的系统级编程语言来说，一个值被存储在栈上还是被存储在堆上会极大地影响到语言的行为。

**栈**： 先进后出，添加数据这一操作被称作入栈，移除数据则被称作出栈。所有存储在栈中的数据都必须拥有一个已知且固定的大小。将值压入栈中不叫分配。由于指针的大小是固定的且可以在编译期确定，所以可以将指针存储在栈中。当你想要访问指针所指向的具体数据时，可以通过指针指向的地址来访问。

**堆**：对于那些在编译期无法确定大小的数据，你就只能将它们存储在堆中。堆空间的管理是较为松散的：当你希望将数据放入堆中时，你就可以请求特定大小的空间。操作系统会根据你的请求在堆中找到一块足够大的可用空间，将它标记为已使用，并把指向这片空间地址的指针 返回给我们。这一过程就是所谓的堆分配 ，它也常常被简称为分配。



向栈上推入数据要比在堆上进行分配更有效率一些，因为操作系统省去了搜索新数据存储位置的工作；这个位置永远处于栈的顶端。除此之外，操作系统在堆上分配空间时还必须首先找到足够放下对应数据的空间，并进行某些记录工作来协调随后进行的其余分配操作。

许多系统编程语言都需要你记录代码中分配的堆空间，最小化堆上的冗余数据，并及时清理堆上的无用数据以避免耗尽空间。而所有权概念则解决了这些问题。一旦你熟练地掌握了所有权及其相关工具，就可以将这些问题交给Rust处理，减轻用于思考栈和堆的心智负担。不过，知晓如何使用和管理堆内存可以帮助我们理解所有权存在的意义及其背后的工作原理。















