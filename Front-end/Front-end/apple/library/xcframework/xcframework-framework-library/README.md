# XCFramework、Framework、Library

在 iOS 开发中，**XCFramework**、**Framework** 和 **Library** 都是封装和分发代码的方式，但它们在功能、使用场景和支持的平台等方面有明显的区别。以下是三者的详细对比：

***

#### **1. 定义**

* **XCFramework**:
  * 一种现代化的框架格式，支持多平台和多架构。
  * Apple 在 Xcode 11 引入，解决传统 `.framework` 无法轻松支持多平台的问题。
* **Framework**:
  * 一种动态或静态的模块化代码打包方式，适用于封装功能、共享代码或提供闭源模块。
  * 通常仅支持单一架构或需要手动管理多架构支持。
* **Library**:
  * 最基本的代码封装形式，包括 **静态库（`.a`）** 和 **动态库（`.dylib`）**。
  * 不支持资源和元数据的封装，通常与头文件（`.h`）一起分发。

***

#### **2. 使用场景**

| 类型              | 使用场景                                                            |
| --------------- | --------------------------------------------------------------- |
| **XCFramework** | - 需要支持多个平台（iOS、iOS Simulator、macOS、watchOS、tvOS）。- 分发闭源库时的推荐选择。 |
| **Framework**   | - 封装模块化代码，便于共享。- 动态链接或静态链接到应用程序。适合单一平台的开发。                      |
| **Library**     | - 适合不包含资源的简单功能库。- 需要最小化文件大小或更高性能的场景（如静态库）。                      |

***

#### **3. 支持的平台**

| 特性        | **XCFramework**             | **Framework** | **Library** |
| --------- | --------------------------- | ------------- | ----------- |
| **多平台支持** | 是（iOS、macOS、watchOS、tvOS 等） | 否（单一平台）       | 否（单一平台）     |
| **多架构支持** | 是（arm64、x86\_64、armv7 等）    | 是（需要手动管理）     | 是（需要手动管理）   |

***

#### **4. 结构与内容**

| 特性        | **XCFramework**             | **Framework**      | **Library**                |
| --------- | --------------------------- | ------------------ | -------------------------- |
| **包含资源**  | 是（资源文件、头文件、二进制库等）           | 是（可以包含资源文件）        | 否（仅包含二进制代码）                |
| **包含元数据** | 是（包含 Info.plist 描述平台、架构等信息） | 是（可以包含 Info.plist） | 否                          |
| **二进制代码** | 可以包含多个平台和架构的静态或动态库          | 通常是一个单独的静态或动态库     | 仅包含静态库（`.a`）或动态库（`.dylib`） |

***

#### **5. 编译与分发**

| 特性           | **XCFramework**                               | **Framework**                                 | **Library**              |
| ------------ | --------------------------------------------- | --------------------------------------------- | ------------------------ |
| **编译方式**     | 使用 `xcodebuild -create-xcframework` 命令创建      | 使用 Xcode 或其他构建工具创建                            | 使用 Xcode 或其他工具创建         |
| **分发**       | 推荐用于分发闭源库，尤其是跨平台的场景                           | 通常用于单一平台，闭源或开源场景皆可                            | 通常与头文件一同分发               |
| **依赖管理工具支持** | 支持 CocoaPods、Carthage、Swift Package Manager 等 | 支持 CocoaPods、Carthage、Swift Package Manager 等 | 支持 CocoaPods 等，但需要手动管理架构 |

***

#### **6. 优势与劣势**

| 类型              | 优势                                       | 劣势                                         |
| --------------- | ---------------------------------------- | ------------------------------------------ |
| **XCFramework** | - 支持多平台和多架构。- 易于分发，解决架构冲突问题。- 支持动态库和静态库。 | - 文件体积较大。- 不适合只支持单一平台的简单项目。                |
| **Framework**   | - 简单易用，支持动态或静态库。- 可以封装资源文件。              | - 仅支持单一平台。- 手动支持多架构较复杂。                    |
| **Library**     | - 轻量化，性能高（尤其是静态库）。- 文件大小小。               | - 不支持资源文件。- 分发复杂（需要附加头文件）。- 静态库会增加最终应用的大小。 |

***

#### **7. 具体选择建议**

* **选择 XCFramework**：
  * 如果需要支持多个 Apple 平台（iOS、macOS、watchOS 等）。
  * 如果需要分发闭源库，同时支持多种架构和模拟器。
* **选择 Framework**：
  * 如果只需要支持单一平台，且框架中需要封装资源文件（如图片、xib 文件等）。
  * 如果需要动态加载框架（如插件式功能模块）。
* **选择 Library**：
  * 如果是简单功能的代码封装（如算法、数据处理等），且不需要封装资源文件。
  * 如果希望最大限度优化性能（静态库）或动态加载代码（动态库）。

***

#### **总结**

* 如果是现代化的分发和跨平台需求，**XCFramework** 是首选。
* 如果只需要单平台支持，且代码较为复杂或依赖资源，使用 **Framework**。
* 如果需要高性能或轻量封装，使用 **Library**（通常是静态库）。
